---
/** Props
 * title: string
 * blurb: string
 * tech: string[]
 * image: string          // /images/xxx.jpg or remote
 * github?: string
 * external?: string
 * reverse?: boolean      // flip layout like Brittany
 * index?: number         // to stagger reveal delays
 */
 const { title, blurb, tech = [], image, github, external, reverse = false, index = 0 } = Astro.props;
import ScrollReveal from './ScrollReveal';
const delay = 100 + index * 120;
---
<ScrollReveal client:load variant="slide-up" duration={600} threshold={0.12} delay={delay} distance={28}>
  <article class={`group relative grid md:grid-cols-12 gap-4 items-center`}>
    <!-- IMAGE COLUMN -->
    <div class={`relative z-10 row-start-1 md:row-auto
                 ${reverse ? 'md:col-span-7 md:col-start-6' : 'md:col-span-7 md:col-start-1'}`}>
      <a href={external ?? github ?? '#'} target="_blank" rel="noopener noreferrer" class="block">
        <div class="relative rounded-md overflow-hidden border border-[var(--color-border)] transition-all duration-300
                    group-hover:border-[var(--color-accent-primary)]">
          <img
            src={image}
            alt={title}
            loading="lazy"
            class="aspect-video w-full object-cover opacity-90 mix-blend-normal
                   transition-transform duration-500 group-hover:scale-[1.02]"
          />
          <!-- subtle tint like Brittany -->
          <div class="absolute inset-0 bg-[var(--color-accent-primary)]/10 group-hover:bg-transparent transition-colors"></div>
        </div>
      </a>
    </div>

    <!-- CONTENT COLUMN -->
    <div class={`relative z-20 row-start-1 md:row-auto
                 ${reverse ? 'md:col-span-6 md:col-start-1 text-right' : 'md:col-span-6 md:col-start-7 text-left'}`}>
      <p class={`font-mono text-xs tracking-wider uppercase mb-2 text-[var(--color-accent-primary)]
                 ${reverse ? 'md:text-right' : 'md:text-left'}`}>
        Featured Project
      </p>

      <h3 class={`text-2xl md:text-3xl font-bold mb-4 text-[var(--color-text-primary)]
                  group-hover:text-[var(--color-accent-primary)] transition-colors
                  ${reverse ? 'md:text-right' : 'md:text-left'}`}>
        <a href={external ?? github ?? '#'} target="_blank" rel="noopener noreferrer">{title}</a>
      </h3>

      <!-- Overlapping panel -->
      <div class={`bg-[var(--color-bg-secondary)] border border-[var(--color-border)]
                   shadow-lg rounded-md p-6 mb-4
                   ${reverse ? 'md:-mr-12' : 'md:-ml-12'}`}>
        <p class="text-[var(--color-text-secondary)] leading-relaxed">{blurb}</p>
      </div>

      <ul class={`flex flex-wrap gap-3 mb-4 font-mono text-xs sm:text-sm text-[var(--color-text-muted)]
                  ${reverse ? 'justify-end' : 'justify-start'}`}>
        {tech.map((t: unknown) => <li>{t}</li>)}
      </ul>

      <div class={`flex gap-4 ${reverse ? 'justify-end' : 'justify-start'}`}>
        {github && (
          <a href={github} target="_blank" rel="noopener noreferrer" aria-label="GitHub"
             class="text-[var(--color-text-secondary)] hover:text-[var(--color-accent-primary)] transition-colors">
            <!-- GitHub icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
          </a>
        )}
        {external && (
          <a href={external} target="_blank" rel="noopener noreferrer" aria-label="External link"
             class="text-[var(--color-text-secondary)] hover:text-[var(--color-accent-primary)] transition-colors">
            <!-- External icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
          </a>
        )}
      </div>
    </div>
  </article>
</ScrollReveal>
